{"version":3,"sources":["webpack:///webpack/bootstrap 222b68d8632e18ebc59d","webpack:///./src/index.ts","webpack:///external \"os\"","webpack:///./src/utils.ts","webpack:///external \"child_process\"","webpack:///external \"util\""],"names":[],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 222b68d8632e18ebc59d","import * as os from 'os';\nimport * as utils from './utils';\nimport * as util from 'util'\nimport {IDevice} from \"./utils\";\nimport {IConfig} from \"./utils\";\n\nlet Kelvin, Accessory, Service, Characteristic, UUIDGen\n\nconst UUID_KELVIN = 'C4E24248-04AC-44AF-ACFF-40164E829DBA'\n\nexport = function(homebridge) {\n  Accessory = homebridge.platformAccessory\n  Service = homebridge.hap.Service\n  Characteristic = homebridge.hap.Characteristic\n  UUIDGen = homebridge.hap.uuid // @TODO: Should be using this\n  \n  Characteristic.Kelvin = function() {\n      Characteristic.call(this, 'Kelvin', UUID_KELVIN)\n\n      this.setProps({\n          format: Characteristic.Formats.INT,\n          unit: 'Kelvin',\n          maxValue: 4000,\n          minValue: 2200,\n          minStep: 1,\n          perms: [Characteristic.Perms.READ, Characteristic.Perms.WRITE]\n      });\n\n      this.value = this.getDefaultValue();\n  }\n  util.inherits(Characteristic.Kelvin, Characteristic);\n  Characteristic.Kelvin.UUID = UUID_KELVIN  \n\n  homebridge.registerPlatform(\"homebridge-ikea\", \"Ikea\", IkeaPlatform)\n}\n\nfunction IkeaPlatform(log, config: IConfig) {\n  this.log = log\n  this.config = config\n  this.config.log = this.log\n  this.devices = []\n\n  if (!this.config.coapClient && (os.platform() !== \"darwin\" && os.platform() !== \"linux\")) {\n    throw Error(\"No coap-client found, please specify the path to it using coapClient\")\n  }\n  this.config.coapClient = this.config.coapClient || `${__dirname}/bin/coap-client-${os.platform()}`\n\n}\n\nIkeaPlatform.prototype = {\n  accessories: async function(callback) {\n    const self = this\n    const foundAccessories = []\n\n    const devices = await utils.getDevices(self.config);\n\n    await Promise.all(devices.map(async deviceId => {\n      const device = await utils.getDevice(self.config, deviceId)\n      if (device.type === 2) {\n        foundAccessories.push(new IkeaAccessory(self.log, self.config, device))\n      }\n    }))\n\n    callback(foundAccessories)\n  }\n}\n\n\n\nfunction IkeaAccessory(log, config, device: IDevice) {\n  this.name = device.name\n  this.config = config\n  this.config.log = string => log(\"[\" + this.name + \"] \" + string)\n  this.device = device\n\n  this.currentBrightness = this.device.light[0][\"5851\"]\n  this.currentState = this.device.light[0][\"5850\"]\n  this.previousBrightness = this.currentBrightness\n  this.color = {}\n}\n\nIkeaAccessory.prototype = {\n  // Respond to identify request\n  identify: function(callback) {\n    this.config.log(\"Hi!\")\n    callback()\n  },\n\n  getServices: function() {\n    const accessoryInformation = new Service.AccessoryInformation()\n    accessoryInformation\n    .setCharacteristic(Characteristic.Name, this.device.name)\n    .setCharacteristic(Characteristic.Manufacturer, this.device.details[\"0\"])\n    .setCharacteristic(Characteristic.Model, this.device.details[\"1\"])\n    .setCharacteristic(Characteristic.FirmwareRevision, this.device.details[\"3\"])\n\n    const self = this\n\n    const lightbulbService = new Service.Lightbulb(self.name)\n    \n    lightbulbService\n    .addCharacteristic(Characteristic.StatusActive)\n    \n    lightbulbService\n    .setCharacteristic(Characteristic.StatusActive, this.device.reachabilityState)\n    .setCharacteristic(Characteristic.On, this.device.light[0][\"5850\"])\n    .setCharacteristic(Characteristic.Brightness, parseInt(String(Math.round(this.device.light[0][\"5851\"] * 100 / 255))))\n    \n\n    lightbulbService\n    .getCharacteristic(Characteristic.StatusActive)\n    .on('get', callback => {\n      utils.getDevice(self.config, self.device.instanceId).then(device => {\n        callback(null, device.reachabilityState)\n      })\n    })\n\n    lightbulbService\n    .getCharacteristic(Characteristic.On)\n    .on('get', callback => {\n      utils.getDevice(self.config, self.device.instanceId).then(device=> {\n        self.currentBrightness = device.light[0][\"5851\"]\n        self.currentState = device.light[0][\"5850\"]\n        callback(null, self.currentState)\n      })\n    })\n    .on('set', (state, callback) => {\n      if (typeof state !== 'number') {\n        state = state ? 1 : 0;\n      }    \n      \n      if (self.currentState == 1 && state == 0) { // We're turned on but want to turn off.\n        self.currentState = 0\n        utils.setBrightness(self.config, self.device.instanceId, 0, result => callback())\n      } else if(self.currentState == 0 && state == 1) {\n        self.currentState = 1\n        utils.setBrightness(self.config, self.device.instanceId, (self.currentBrightness > 1 ? self.currentBrightness : 255), result => callback())\n      } else {\n        callback()\n      }\n    })\n\n    lightbulbService\n    .getCharacteristic(Characteristic.Brightness)\n    .on('get', callback => {\n      utils.getDevice(self.config, self.device.instanceId).then(device => {\n        self.currentBrightness = device.light[0][\"5851\"]\n        self.currentState = device.light[0][\"5850\"]\n        callback(null, parseInt(String(Math.round(self.currentBrightness * 100 / 255))))\n      })\n    })\n    .on('set', (powerOn, callback) => {\n      self.currentBrightness = Math.floor(255 * (powerOn / 100))\n      utils.setBrightness(self.config, self.device.instanceId, Math.round(255 * (powerOn / 100)), result => callback())\n    })\n            \n    if(typeof this.device.light[0][\"5706\"] !== 'undefined'){\n        if(this.device.light[0][\"5706\"].length < 6){\n            this.device.light[0][\"5706\"] = \"ffcea6\" //Default value when it was offline\n        }\n        \n        var hsl = utils.convertRGBToHSL(this.device.light[0][\"5706\"]);\n        \n        lightbulbService\n        .addCharacteristic(Characteristic.Kelvin)\n\n        lightbulbService\n        .setCharacteristic(Characteristic.Kelvin, utils.getKelvin(this.device.light[0][\"5709\"]))\n        .setCharacteristic(Characteristic.Hue, hsl[0] * 360)\n        .setCharacteristic(Characteristic.Saturation, hsl[1] * 100)\n        \n        \n        lightbulbService\n        .getCharacteristic(Characteristic.Kelvin)\n        .on('get', callback => {\n          utils.getDevice(self.config, self.device.instanceId).then(device => {\n            self.currentKelvin = utils.getKelvin(device.light[0][\"5709\"])\n            callback(null, self.currentKelvin)\n          })\n        })\n        .on('set', (kelvin, callback) => {\n          utils.setKelvin(self.config, self.device.instanceId, kelvin, result => callback())\n        })\n\n        lightbulbService\n          .getCharacteristic(Characteristic.Hue)\n          .on('get', callback => {\n            utils.getDevice(self.config, self.device.instanceId).then(device => {\n              if(typeof device.light[0][\"5706\"] !== 'undefined' || device.light[0][\"5706\"].length < 6){\n                device.light[0][\"5706\"] = \"ffcea6\" //Default value when it fails polling\n              }\n              let hsl = utils.convertRGBToHSL(device.light[0][\"5706\"]);\n              callback(null, hsl[0] * 360)\n            })\n\n          })\n          .on('set', (hue, callback) => {\n            self.color.hue = hue / 360\n            if (typeof self.color.saturation !== 'undefined') {\n              utils.setColor(self.config, self.device.instanceId, self.color, result => callback())\n              self.color = {}\n            }else{\n              callback()            \n            }\n          })\n\n        lightbulbService\n          .getCharacteristic(Characteristic.Saturation)\n          .on('get', callback => {\n            utils.getDevice(self.config, self.device.instanceId).then(device => {\n              if(typeof device.light[0][\"5706\"] !== 'undefined' || device.light[0][\"5706\"].length < 6){\n                device.light[0][\"5706\"] = \"ffcea6\" //Default value when it fails polling\n              }\n              let hsl = utils.convertRGBToHSL(device.light[0][\"5706\"]);\n              callback(null, hsl[1] * 100)\n            })\n\n          })\n          .on('set', (saturation, callback) => {\n            self.color.saturation = saturation / 100\n            if (typeof self.color.hue !== 'undefined') {\n              utils.setColor(self.config, self.device.instanceId, self.color, result => callback())\n              self.color = {}\n            }else{\n              callback()            \n            }\n          })\n    }\n\n    return [accessoryInformation, lightbulbService]\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","module.exports = require(\"os\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"os\"\n// module id = 1\n// module chunks = 0","var execSync = require('child_process').execSync\n\nconst coap = (method: \"get\" | \"post\" | \"put\", config: IConfig, payload: string = \"{}\") => `${config.coapClient} -u \"Client_identity\" -k \"${config.psk}\" -e '${payload}' -m ${method} coaps://${config.ip}/15001/`\n\nconst put = (config, id, payload) => coap(\"put\", config, payload) + id\nconst get = (config, id=\"\") => coap(\"get\", config) + id\n\nconst kelvinToPercent = (kelvin: number) => (kelvin - 2200) / 18 // 4000\nconst percentToKelvin = (percent: number) => 2200 + (18 * percent) // 4000\nconst colorX = percent => Math.round(33135 - (82.05 * percent))  // 24930\nconst colorY = percent => Math.round(27211 - (25.17 * (100 - percent))) // 24694\n\nexport const getKelvin = colorX => percentToKelvin(Math.round((33135 - colorX) / 82.05))\n\nexport let setBrightness = (config, id, brightness: number, callback) => {\n  const values = `{ \"3311\" : [{ \"5851\" : ${brightness}} ] }`\n  const cmd = put(config, id, values)\n\n  if (config.debug) {\n    config.log(`Setting brightness of ${brightness} for ${id}`)\n    config.log(cmd)\n  }\n\n  callback(execSync(cmd, {encoding: \"utf8\"}))\n}\n\nexport let setKelvin = (config, id, kelvin, callback) => {\n  const values = `{ \"3311\" : [{ \"5709\" : ${colorX(kelvinToPercent(kelvin))}, \"5710\": ${colorY(kelvinToPercent(kelvin))} }] }`\n  var cmd = put(config, id, values);\n\n  if (config.debug) {\n    config.log(cmd)\n  }\n  callback(execSync(cmd, {encoding: \"utf8\"}))\n}\n  \n// Source: http://stackoverflow.com/a/9493060\nconst hslToRgb = (h, s, l): [number,  number,  number] => {\n  var r, g, b;\n\n  if(s == 0){\n    r = g = b = l; // achromatic\n  } else {\n    var hue2rgb = function hue2rgb(p, q, t){\n      if(t < 0) t += 1;\n      if(t > 1) t -= 1;\n      if(t < 1/6) return p + (q - p) * 6 * t;\n      if(t < 1/2) return q;\n      if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n      return p;\n    }\n\n    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    var p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1/3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1/3);\n  }\n\n  return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\n};\n\nconst hexToRgb = (hex) => {\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16)\n    } : null;\n}\n\nconst rgbToHsl = (r, g, b): [number,  number,  number] => {\n    r /= 255, g /= 255, b /= 255;\n    var max = Math.max(r, g, b), min = Math.min(r, g, b);\n    var h, s, l = (max + min) / 2;\n\n    if(max == min){\n        h = s = 0; // achromatic\n    }else{\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch(max){\n            case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n            case g: h = (b - r) / d + 2; break;\n            case b: h = (r - g) / d + 4; break;\n        }\n        h /= 6;\n    }\n\n    return [h, s, l];\n}\n\n// Source http://stackoverflow.com/a/36061908\nconst rgbToXy = (red?: number,green?: number,blue?:number): [string, string] => {\n  red = (red > 0.04045) ? Math.pow((red + 0.055) / (1.0 + 0.055), 2.4) : (red / 12.92);\n  green = (green > 0.04045) ? Math.pow((green + 0.055) / (1.0 + 0.055), 2.4) : (green / 12.92);\n  blue = (blue > 0.04045) ? Math.pow((blue + 0.055) / (1.0 + 0.055), 2.4) : (blue / 12.92);\n  var X = red * 0.664511 + green * 0.154324 + blue * 0.162028;\n  var Y = red * 0.283881 + green * 0.668433 + blue * 0.047685;\n  var Z = red * 0.000088 + green * 0.072310 + blue * 0.986039;\n  var fx = X / (X + Y + Z);\n  var fy = Y / (X + Y + Z);\n  return [fx.toPrecision(4),fy.toPrecision(4)];\n}\n\nexport let convertRGBToHSL = (hex) => {\t\n  var c = hexToRgb(hex)\n  return rgbToHsl(c.r, c.g, c.b);\n}\n\nexport let setColor = (config, id, color, callback) => {\n  // First we convert hue and saturation\n  // to RGB, with 75% lighntess\n  const rgb = hslToRgb(color.hue, color.saturation, 0.75);\n  // Then we convert the rgb values to\n  // CIE L*a*b XY values\n  const cie = rgbToXy(...rgb).map(item => {\n    // we need to scale the values\n    return Math.floor(100000 * parseFloat(item));\n  });  \n  \n  const values = `{ \"3311\" : [{ \"5709\" : ${cie[0]}, \"5710\": ${cie[1]} }] }`\n  const cmd = put(config, id, values)\n  \n  if (config.debug) {\n    config.log(cmd)\n  }\n  callback(execSync(cmd, {encoding: \"utf8\"}))\n}\n\n// @TODO: Figure out if the gateway actually don't support this\nexport let setOnOff = (config, id, state, callback) => {\n  const values = `{ \"3311\" : [{ \"5580\" : ${state}} ] }`\n  var cmd = put(config, id, values)\n\n  if (config.debug) {\n    config.log(cmd)\n  }\n  callback(execSync(cmd, {encoding: \"utf8\"}))\n}\n\nconst parseDeviceList = str => {\n  const split = str.trim().split(\"\\n\")\n  return split.pop().slice(1,-1).split(\",\")\n}\n\n\nexport let getDevices = config => new Promise<Array<IDevice>>((resolve, reject) => {\n  var cmd = get(config)\n  if (config.debug) {\n    config.log(cmd)\n  }\n\n  resolve(parseDeviceList(execSync(cmd, {encoding: \"utf8\"})))\n})\n\nconst parseDevice = str => {\n  const split = str.trim().split(\"\\n\")\n  const json = JSON.parse(split.pop())\n\n  return {\n    name: json[\"9001\"],\n    type: json[\"5750\"],\n    createdAt: json[\"9002\"],\n    instanceId: json[\"9003\"],\n    details: json[\"3\"],\n    reachabilityState: json[\"9019\"],\n    lastSeen: json[\"9020\"],\n    otaUpdateState: json[\"9054\"],\n    switch: json[\"15009\"],\n    light: json[\"3311\"]\n  }\n\n  /*\n    light: {\n    {\n       onoff: json[\"3311\"][\"5580\"],\n       dimmer: json[\"3311\"][\"5851\"],\n       color_x: json[\"3311\"][\"5709\"],\n       color_y: json[\"3311\"][\"5710\"],\n       color: json[\"3311\"][\"5706\"],\n       instance_id: json[\"3311\"][\"9003\"],\n       \"5707\":0,\n       \"5708\":0,\n       \"5711\":0,\n      }\n    }\n  */\n}\n\nexport interface IDevice{\n\n    name: string;\n    type: number;\n    reachabilityState: any;\n    light: any;\n}\n\nexport interface IConfig{\n    ip: string;\n    psk: string;\n    coapClient: string;\n}\n\nexport let getDevice = (config, id): Promise<IDevice> => new Promise<IDevice>((resolve, reject) => {\n\n  var cmd = get(config, id)\n  if (config.debug) {\n    config.log(`Get device information for: ${id}`)\n    config.log(cmd)\n  }\n\n  resolve(parseDevice(execSync(cmd, {encoding: \"utf8\"})))\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.ts","module.exports = require(\"child_process\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"child_process\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"util\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"util\"\n// module id = 4\n// module chunks = 0"],"sourceRoot":""}